<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="/style/main.css" />
    <link rel="stylesheet" href="/style/base.css" />
    <link rel="stylesheet" href="/style/grid.css" />
    <link rel="stylesheet" href="/style/responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
    />
  </head>
  <body>
    <div class="app">
      <!-- Header -->
      <header class="header">
        <div class="grid wide">
          <nav class="header__navbar hide-on-mobile-tablet">
            <ul class="header__navbar-list">
              <li
                class="header__navbar-item header__navbar-item--separate"
              >
                Chăm sóc khách hàng
              </li>
              <li class="header__navbar-item">
                <span class="header__navbar-title--no-pointer">Kết nối</span>

                <a href="" class="header__navbar-icon-link">
                  <i class="header__navbar-icon fab fa-facebook"></i>
                </a>
                <a href="" class="header__navbar-icon-link">
                  <i class="header__navbar-icon fab fa-instagram"></i>
                </a>
              </li>
            </ul>
            <ul class="header__navbar-list">
              <li class="header__navbar-item">
                <a href="" class="header__navbar-item-non-link">
                  <i class="header__navbar-icon fas fa-home"></i>
                    Homepage
                </a>
              </li>
            </li>
            <li class="header__navbar-item">
              <a href="" class="header__navbar-item-non-link">
                <i class="header__navbar-icon fas fa-shopping-cart"></i>
                  Cart
              </a>
            </li>
              <li class="header__navbar-item header__navbar-user">
                <img
                  src="/img/user_img.png"
                  alt="avatar"
                  class="header__navbar-user-img"
                />

                <span class="header__navbar-user-name">
                  LMEO
                </span>

                <ul class="header__navbar-user-menu">
                  <li class="header__navbar-user-item">
                    <a href="">Tài khoản của tôi</a>
                  </li>
                  <li class="header__navbar-user-item">
                    <a href="">Địa chỉ của tôi</a>
                  </li>
                  <li class="header__navbar-user-item">
                    <a href="">Đơn mua</a>
                  </li>
                  <li
                    class="header__navbar-user-item header__navbar-user-item--separate"
                  >
                    <a href="">Đăng xuất</a>
                  </li>
                </ul>
              </li>
            </ul>
          </nav>

          <!-- Header with Search -->
          <div class="header-with-search">
            <label for="mobile-search-checkbox" class="header__mobile-search">
              <i class="header__mobile-search-icon fas fa-search"></i>
            </label>

            <!-- Header Logo -->
            <div class="header__logo hide-on-tablet">
                <a href="" class="header__logo-link">
                <img class="header__logo-img" src="/img/logo_img.png" alt="Custom Logo">
                </a>
            </div>
            <input
              type="checkbox"
              hidden
              id="mobile-search-checkbox"
              class="header__search-checkbox"
            />
            <!-- Header Search -->
            <div class="header__search">
              <div class="header__search-input-wrap">
                <input
                  type="text"
                  class="header__search-input"
                  id="search-input"
                  placeholder="Search"
                  oninput="handleSearchInput()"
                />
                
                <!-- Search history -->
                <div class="header__search-history" id="search-history">
                  <h3 class="header__search-history-heading">Lịch sử tìm kiếm</h3>
                  <ul class="header__search-history-list" id="search-history-list">
                    <!-- Các mục tìm kiếm trước đây sẽ được hiển thị ở đây -->
                  </ul>
                </div>
              </div>
              
              <button class="header__search-btn" id="search-btn">
                <i class="header__search-btn-icon fas fa-search"></i>
              </button>
            </div>
            
          </div>
        </div>
      </header>
      <!-- Content -->
      <div class="app__container">
        <div class="grid wide">
          <div class="row sm-gutter app__content">

            <!-- Label -->
            <div class="col l-2 m-0 c-0"> 
                <nav class="category">
                  <h3 class="category__heading">
                    LABEL
                  </h3>
                  <ul class="category-list">
                    <div class="price-options">
                      <div class="price-option active" onclick="selectOption(this)">Price ascending</div>
                      <div class="price-option" onclick="selectOption(this)">Price descending</div>
                    </div>
                    <div class="add-product-btn">
                      <i class="fas fa-check"></i>
                      <span>Add product</span>
                    </div>
                    <div class="add-product-btn">
                      <i class="fas fa-check"></i>
                      <span>Update product</span>
                    </div>
                    <div class="add-product-btn">
                      <i class="fas fa-cog"></i>
                      <span>View order</span>
                    </div>
                    <div class="add-product-btn">
                      <i class="fas fa-eye"></i>
                      <span>Shop profile</span>
                    </div>
                  </ul>
                </nav>
              </div>

              <div class="col l-10 m-12 c-12">
              <!-- Product -->
              <div class="home-product">
                <% for (let rowIndex = 0; rowIndex < products.length; rowIndex += 5) { %>
                  <div class="row sm-gutter">
                    <% products.slice(rowIndex, rowIndex + 5).forEach(product => { %>
                      <div class="col l-2-4 m-4 c-6">
                        <a href="#" class="home-product-item">
                          <div class="home-product-item__img" style="background-image: url('<%= product.images[0] %>');"></div>
                          <h4 class="home-product-item__name"><%= product.name %></h4>
                          <div class="home-product-item__price">
                            <span class="home-product-item__price-current"><%= product.name %></span>
                          </div>
                          <div class="home-product-item__action">
                            <div class="home-product-item__rating">
                              <% for (let i = 0; i < 5; i++) { %>
                                <% if (i < product.rate) { %>
                                  <i class="home-product-item__star--gold fas fa-star"></i>
                                <% } else { %>
                                  <i class="fas fa-star"></i>
                                <% } %>
                              <% } %>
                            </div>
                          </div>
                        </a>
                      </div>
                    <% }); %> 
                  </div>
                <% } %>
              </div>
              
            </div>
          </div>
        </div>
      </div>
      <!-- Footer -->
      <footer class="footer">
        <div class="grid wide footer__content">
          <div class="row">
            <div class="col l-2-8 m-4 c-6">
              <h3 class="footer__heading">CHĂM SÓC KHÁCH HÀNG</h3>
              <ul class="footer-list">
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Trung Tâm Trợ Giúp</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Hướng Dẫn Mua Hàng</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link"
                    >Chính Sách Vận Chuyển</a
                  >
                </li>
              </ul>
            </div>
            <div class="col l-2-8 m-4 c-6">
              <h3 class="footer__heading">VỀ CHÚNG TÔI</h3>
              <ul class="footer-list">
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Giới Thiệu Về Shop</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Tuyển Dụng</a>
                </li>
                <li class="footer-item">
                  <a href="#" class="footer-item__link">Điều Khoản Shop</a>
                </li>
              </ul>
            </div>
            <div class="col l-2-4 m-8 c-12">
              <h3 class="footer__heading">ĐỊA CHỈ CỦA TRANG WEB</h3>
              <div class="footer__download">
                <img
                  src="/img/qr_code.png"
                  alt="Download QR"
                  class="footer__dowload-qr"
                />
              </div>
            </div>
          </div>
        </div>
        <div class="footer__bottom">
          <div class="grid wide">
            <p class="footer__text">
              © 2024 Triết lí cuộc sống - Đời là bể khổ, qua được bể khổ là qua đời
            </p>
          </div>
        </div>
      </footer>
    </div>
    <script>
      const savedSearchHistory = JSON.parse(localStorage.getItem('searchHistory')) || [];
    
      const searchInput = document.getElementById('search-input');
      const searchBtn = document.getElementById('search-btn');
      const searchHistoryDiv = document.getElementById('search-history');
      const searchHistoryList = document.getElementById('search-history-list');
    
      function addSearchHistory(query) {
        if (!savedSearchHistory.includes(query)) {
          savedSearchHistory.unshift(query);
          if (savedSearchHistory.length > 5) { 
            savedSearchHistory.pop();
          }
          localStorage.setItem('searchHistory', JSON.stringify(savedSearchHistory));
        }
      }
    
      function handleSearchInput() {
        const query = searchInput.value.trim();
    
        if (query) {
          searchHistoryDiv.style.display = 'block';
          searchHistoryList.innerHTML = ''; 
    
          const filteredHistory = savedSearchHistory.filter(item => item.toLowerCase().includes(query.toLowerCase()));
          filteredHistory.forEach(item => {
            const listItem = document.createElement('li');
            listItem.classList.add('header__search-history-item');
            listItem.innerHTML = `<a href="#">${item}</a>`;
            listItem.addEventListener('click', function () {
              searchInput.value = item;
              searchHistoryDiv.style.display = 'none';
            });
            searchHistoryList.appendChild(listItem);
          });
        } else {
          searchHistoryDiv.style.display = 'none';
        }
      }
    
      searchBtn.addEventListener('click', function () {
        const query = searchInput.value.trim();
        if (query) {
          addSearchHistory(query);
          window.location.href = `/search/${encodeURIComponent(query)}`;
        }
      });
    
      searchInput.addEventListener('input', handleSearchInput);
    
      window.onload = function () {
        if (savedSearchHistory.length > 0) {
          searchHistoryDiv.style.display = 'block';
    
          savedSearchHistory.forEach(item => {
            const listItem = document.createElement('li');
            listItem.classList.add('header__search-history-item');
            listItem.innerHTML = `<a href="#">${item}</a>`;
            listItem.addEventListener('click', function () {
              searchInput.value = item;
              searchHistoryDiv.style.display = 'none';
            });
            searchHistoryList.appendChild(listItem);
          });
        }
      };
    </script>
    
  </body>
</html>